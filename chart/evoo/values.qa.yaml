service:
  env: qa
  tribe: infra
  replicas: 1

  image:
    tag: 0.0.1
    repository: eslamanwar/rilo
    pullPolicy: Always

  serviceAccount:
    create: false

  ingress:
    enabled: false

  containerPort: 8000
  service:
    type: ClusterIP
    port: 8000

  revisionHistoryLimit: 10
  rollingUpdate:
    maxUnavailable: 25%
    maxSurge: 25%

  resources:
    limits:
      cpu: 500m
      memory: 500Mi
    requests:
      cpu: 250m
      memory: 250Mi

  horizontalPodAutoscaler:
    enabled: false
    minReplicas: 1
    maxReplicas: 1
    metrics:
      - type: Resource
        resource:
          name: cpu
          target:
            type: Utilization
            averageUtilization: 80

  verticalPodAutoscaler:
    enabled: false

  readinessProbe:
    httpGet:
      path: /healthz
      port: 8000
      scheme: HTTP
    timeoutSeconds: 2
    periodSeconds: 10
    successThreshold: 1
    failureThreshold: 3

  livenessProbe:
    tcpSocket:
      port: 8000
    timeoutSeconds: 2
    periodSeconds: 15
    successThreshold: 1
    failureThreshold: 3

  startupProbe:
    tcpSocket:
      port: 8000
    initialDelaySeconds: 3
    periodSeconds: 10
    timeoutSeconds: 2
    failureThreshold: 30

  environment:
    - name: ACP_URL
      value: "http://agents-evoo.agentex.svc.cluster.local"
    - name: TEMPORAL_ADDRESS
      value: "agentex-temporal-frontend.agentex.svc.cluster.local:7233"
    - name: TEMPORAL_NAMESPACE
      value: "default"
    - name: TEMPORAL_TASK_QUEUE
      value: "evoo-queue"
    - name: WORKFLOW_TASK_QUEUE
      value: "evoo-queue"
    - name: WORKFLOW_NAME
      value: "EVOOWorkflow"
    - name: AGENT_NAME
      value: "evoo"
    - name: OPENAI_BASE_URL
      value: "https://openrouter.ai/api/v1"
    - name: OPENAI_MODEL
      value: "deepseek/deepseek-r1-0528"
    - name: AGENTEX_BASE_URL
      valueFrom:
        secretKeyRef:
          name: agents-evoo
          key: AGENTEX_BASE_URL
    - name: OPENAI_API_KEY
      valueFrom:
        secretKeyRef:
          name: agents-evoo
          key: OPENAI_API_KEY
    - name: AGENT_API_KEY
      valueFrom:
        secretKeyRef:
          name: agents-evoo
          key: AGENT_API_KEY
    - name: MAX_LEARNING_RUNS
      value: "50"
    - name: EXPLORATION_RATE
      value: "0.2"
    - name: MEMORY_FILE_PATH
      value: "/tmp/evoo_data/evoo_memory.json"
    - name: STRATEGY_FILE_PATH
      value: "/tmp/evoo_data/evoo_strategies.json"

  externalSecret:
    enabled: false

  podAnnotations:
    sidecar.istio.io/inject: "false"

# Istio Default values to be added to new services
  istio:
    enabled: true
    ingress:
      routes:
        mainPort: 80
        match:
          - host: evoo.dhhmena.com
            prefix: "/"
    holdApplicationUntilProxyStarts: true
    resources:
      enabled: true
      limits:
        memory: 1024Mi
      requests:
        cpu: 100m
        memory: 128Mi
    retries:
      attempts: 5
      retryOn: gateway-error,connect-failure,refused-stream
    trafficPolicy:
      loadBalancer:
        simple: LEAST_CONN

# Temporal Worker configuration for QA
temporal-worker:
  securityContext:
    privileged: false
  env_vars:
    SERVICE_TYPE: "worker"
    AWS_REGION: "eu-west-2"
    DATABASE_URL: postgresql://postgres:postgres@agentex-postgresql:5432/agentex
    REDIS_URL: redis://agentex-redis-master:6379
    TEMPORAL_HOST: agentex-temporal-frontend
    AGENTEX_SERVER_TASK_QUEUE: agentex-server
    ENVIRONMENT: qa
    OPENAI_BASE_URL: "https://openrouter.ai/api/v1"
    OPENAI_MODEL: "deepseek/deepseek-r1-0528"
    MAX_LEARNING_RUNS: "50"
    EXPLORATION_RATE: "0.2"
    MEMORY_FILE_PATH: "/tmp/evoo_data/evoo_memory.json"
    STRATEGY_FILE_PATH: "/tmp/evoo_data/evoo_strategies.json"
    INCIDENT_INTERVAL_SECONDS: "5"

